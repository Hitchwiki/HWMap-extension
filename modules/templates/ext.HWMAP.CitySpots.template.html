{{#spots.groupSpots:direction}}

<span class="cardinal-direction">
  {{direction}}
</span>

{{#this:index}}
<div class="spot" id="spot_{{id}}">
  <span class="spot-head">
    {{#if CitiesDirection}}<span>Towards </span>{{/if}}
    {{#CitiesDirection:i}}{{#if i>0}},&nbsp;{{/if}}<a href="{{this}}">{{this}}</a>{{/CitiesDirection}}{{#RoadsDirection}},&nbsp;<a href="{{this}}">{{this}}</a>{{/RoadsDirection}}
  </span>
  <span class="spot-right">
    {{#if userId}}<div class="edit-button">Edit</div>{{/if}}
    {{#comment_count}}<div ><i id="comment-spinner-{{id}}" class="fa fa-spinner fa-spin comment-spinner"></i><span onclick="loadComments({{id}}, false, '{{direction}}', {{index}})" class="comments-box">{{comment_count}}</span></div>{{/comment_count}}
    {{^comment_count}}<div><span onclick="toggleComments({{id}})" class="comments-box">+</span></div>{{/comment_count}}
  </span>
  <p>{{{Description}}}</p>
  <div class="spot-footer">
    <div class="ratings">Hitchability:
      <span class="rating-widget average-{{rating_average}}">
        <span class="average {{#if rating_average > 0}}average-{{Math.round(rating_average)}}{{else}}average-null{{/if}} {{#if !userId}}average-no-user{{/if}}">{{average_label}}</span>{{#if userId}}<span id="rate_{{id}}" class="rate {{#if rating_average > 0}}rate-{{Math.round(rating_user)}}{{else}}rate-null{{/if}}">{{#if rating_user}}<small>You rated: </small>{{rating_user_label}}{{else}}Rate{{/if}} <i class="fa fa-caret-down"></i></span>
        <span id="your_rate_{{id}}" class="your-rate">
          <span class="rating-choice-head">{{#if rating_user}}Your rated: {{rating_user_label}}{{else}}Your rating{{/if}}</span>
          <span onclick="addRatings(5, {{id}}, '{{direction}}', {{index}})" class="rating-choice"><span class="bubble bubble-verygood"></span> Very Good</span>
          <span onclick="addRatings(4, {{id}}, '{{direction}}', {{index}})" class="rating-choice"><span class="bubble bubble-good"></span> Good</span>
          <span onclick="addRatings(3, {{id}}, '{{direction}}', {{index}})" class="rating-choice"><span class="bubble bubble-average"></span> Average</span>
          <span onclick="addRatings(2, {{id}}, '{{direction}}', {{index}})" class="rating-choice"><span class="bubble bubble-bad"></span> Bad</span>
          <span onclick="addRatings(1, {{id}}, '{{direction}}', {{index}})" class="rating-choice"><span class="bubble bubble-senseless"></span> Senseless</span>
          {{#timestamp_user}}<span class="rating-choice-timestamp">You rated {{timestamp_user}}</span>
          <span onclick="deleteRating({{id}}, '{{direction}}', {{index}})" class="rating-choice-remove">Remove my rating</span>{{/timestamp_user}}
        </span>{{/if}}
      {{#if rating_count > 0}}<a onclick="loadRatings('{{id}}', false, '{{direction}}', {{index}})" class="rating-count">>See {{rating_count}} votes</a>{{/if}}
      </span>
      <br />
      <div id="spot-ratings-{{id}}" class="spot-ratings">
      <table>
        <tr>
          <th><i class="fa fa-star"></i></th>
          <th><i class="fa fa-users"></i></th>
          <th><i class="fa fa-calendar"></i></th>
        </tr>
        {{#ratings}}
        <tr>
          <td>{{rating_label}}</td>
          <td>{{user_name}}</td>
          <td>{{timestamp_label}}</td>
        </tr>
        {{/ratings}}
      </table>
      </div>
    </div>
  </div>
  <div id="spot-comments-{{id}}" class="spot-comments hide-comment">
    {{#comments}}
    <div class="comment">
      {{#if user_id==userId}}<i onclick="deleteComment('{{comment_id}}', '{{id}}', '{{direction}}', {{index}})" class="fa fa-trash comment-delete"></i>{{/if}}
      {{{commenttext}}}
      <span class="comment-meta">By {{user_name}}, {{timestamp_label}}</span>
    </div>
    {{/comments}}
    {{#if userId}}<textarea class="comment-textarea" placeholder="Add a comment" value='{{this.new_comment}}'></textarea>
    {{else}}<p>Please log in to add a comment</p>{{/if}}
    {{#if this.new_comment.length}}<button class="comment-button" onclick="addComment('{{id}}', '{{direction}}', {{index}})">Add comment</button> {{/if}}
  </div>
</div>
{{/this}}

{{/spots.groupSpots}}
